/* Molecule: editable-text — shared editing and committed states for
   inline contenteditable fields (quotes, headings, names) */

/* ── Editing state ──────────────────────────────────────────────────────── */

.quote-card.editing .edit-pencil {
    color: var(--bn-colour-accent);
}

.quote-card.editing .quote-text {
    min-width: 10rem;
    cursor: text;
}

.editable-text.editing {
    background: var(--bn-colour-editing-bg);
    outline: 1px solid var(--bn-colour-editing-border);
    border-radius: var(--bn-radius-sm);
    padding: var(--bn-space-xs) 0.3rem;
    cursor: text;
}

.name-cell.editing .name-text,
.role-cell.editing .role-text {
    background: var(--bn-colour-editing-bg);
    outline: 1px solid var(--bn-colour-editing-border);
    border-radius: var(--bn-radius-sm);
    padding: 0.1rem 0.3rem;
}

/* ── Committed state (dashed underline indicates edit was made) ─────────── */

.editable-text.edited {
    border-bottom: 1px dashed var(--bn-colour-muted);
}

.name-text.edited,
.role-text.edited {
    border-bottom: 1px dashed var(--bn-colour-accent);
}

/* ── Crop bracket handles ──────────────────────────────────────────────── */

.crop-handle {
    display: inline;
    font-size: 1.15em;
    font-weight: var(--bn-weight-strong);
    color: var(--bn-crop-handle-colour);
    cursor: col-resize;
    user-select: none;
    line-height: 1;
    padding: 0 1px;
    transition: color var(--bn-transition-fast);
    vertical-align: baseline;
}

/* Hide smart quotes when editing — brackets replace them */
.quote-card.editing .smart-quote {
    display: none;
}

.crop-handle:hover {
    color: var(--bn-crop-handle-hover);
}

.crop-handle.dragging {
    color: var(--bn-colour-accent);
}

/* Delayed entrance: hidden initially, fade in after 250ms */
.crop-handle.bracket-delayed {
    opacity: 0;
    visibility: hidden;
}

.crop-handle.bracket-visible {
    opacity: 1;
    visibility: visible;
    animation: bracket-fade-in 0.15s ease;
}

@keyframes bracket-fade-in {
    from { opacity: 0; }
    to   { opacity: 1; }
}

/* ── Crop editable span (hybrid mode contenteditable) ──────────────────── */

.crop-editable {
    background: var(--bn-colour-editing-bg);
    padding: var(--bn-space-xs) 0;
    border-radius: var(--bn-radius-sm);
    outline: none;
}

/* ── Crop word spans (crop/word-span mode) ─────────────────────────────── */

.crop-word {
    display: inline;
    transition: color var(--bn-transition-fast);
}

/* Included region wrapper: continuous yellow background covers words
   AND inter-word spaces — prevents white gaps between word spans */
.crop-included-region {
    background: var(--bn-colour-editing-bg);
    border-radius: 2px;
    padding: 1px 0;
}

/* Excluded words: grey + strikethrough, no yellow */
.crop-word.excluded {
    color: var(--bn-colour-muted);
    text-decoration: line-through;
    text-decoration-color: var(--bn-colour-muted);
    text-decoration-thickness: 1px;
    background: none;
}

/* ── Crop ellipsis (after commit) ──────────────────────────────────────── */

.crop-ellipsis {
    color: var(--bn-colour-muted);
    user-select: none;
    font-style: normal;
}

/* ── Undo button (replaces pencil icon for edited quotes) ──────────────── */

.undo-btn {
    position: absolute;
    top: 0.65rem;
    right: 3.35rem;
    background: none;
    border: none;
    padding: var(--bn-space-xs);
    font-size: 0.8rem;
    cursor: pointer;
    color: var(--bn-colour-muted);
    line-height: 1;
    opacity: 0;
    transition: opacity var(--bn-transition-fast), color var(--bn-transition-fast);
}

blockquote:hover .undo-btn.visible {
    opacity: 1;
}

.undo-btn.visible:hover {
    color: var(--bn-colour-accent);
}
