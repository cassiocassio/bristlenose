# Bristlenose Desktop (macOS)

SwiftUI launcher app that wraps the bristlenose CLI in a native macOS window. See `docs/design-desktop-app.md` for the full design doc.

## Quick start

### 1. Create the Xcode project

Xcode's `.xcodeproj` format is best generated by Xcode itself:

1. Open Xcode → File → New → Project → macOS → App
2. Product Name: **Bristlenose**, Interface: **SwiftUI**, Language: **Swift**
3. Save it in this `desktop/` directory
4. Delete the generated `BristlenoseApp.swift` and `ContentView.swift`
5. Drag the existing `Bristlenose/` folder (with all the `.swift` files) into the Xcode project navigator
6. Make sure all `.swift` files are added to the Bristlenose target
7. In Signing & Capabilities, set to "Sign to Run Locally"
8. Cmd+R to build and run

### 2. Build the sidecar (for full pipeline integration)

```bash
# Install PyInstaller if needed
../.venv/bin/pip install pyinstaller

# Build the bristlenose CLI binary
./scripts/build-sidecar.sh

# Get FFmpeg
./scripts/fetch-ffmpeg.sh
```

Then in Xcode: Build Phases → Copy Bundle Resources → add `Bristlenose/Resources/bristlenose-cli` and `Bristlenose/Resources/ffmpeg`.

### 3. Build a .dmg for distribution

```bash
./scripts/build-dmg.sh
# Output: build/Bristlenose.dmg
```

## Project structure

```
Bristlenose/
  BristlenoseApp.swift        @main entry point
  ContentView.swift           State machine (4 phases)
  Views/
    ReadyView.swift           Drop zone + folder picker
    SelectedView.swift        Folder info + action buttons
    RunningView.swift         Pipeline log
    DoneView.swift            View Report + Start Over
  Model/
    AppPhase.swift            State enum
    ProcessRunner.swift       Sidecar process management
    FolderValidator.swift     File extension checking
  Assets.xcassets/            App icon (placeholder)
  Bristlenose.entitlements    Sandbox disabled for v0.1
  Resources/                  gitignored — built by scripts
scripts/
  build-sidecar.sh            PyInstaller build
  fetch-ffmpeg.sh             FFmpeg download
  build-dmg.sh                .dmg packaging
```

## Notes

- The Xcode project file (`.xcodeproj`) is not committed — generate it locally per step 1 above
- `Resources/` contents are gitignored (large binaries)
- The Swift app spawns the CLI as a subprocess — it does not import Python
- Claude is available as a coding assistant in Xcode 26.3 (add your API key in Xcode Settings)
